sum(resultPerth$score<0)
sum(resultPerth$score==0)
setwd("~/Documents/r_code")
install.packages(pkgs="sentiment_0.2.tar.gz", type="source", repos=NULL)
install.packages("Rstem")
install.packages("Rstem", repos = "http://www.omegahat.org/R")
library(qdap)
install.packages("qdap")
save(melb,file="melbtwit.Rdata")
sum(resultPerth$score<0)
sum(resultPerth$score<0)
sum(resultPerth$score==0)
sum(resultPerth$score>0)
textMelb=laply(melb, function(t) t$getText())
resultMelb=score.sentiment(textMelb, positive.words, negative.words)
sum(resultMelb$score>0)
sum(resultMelb$score<0)
sum(resultMelb$score==0)
dt<-load("melbtwit.R")
?load
load("melbtwit.Rdata",.GlobalEnv)
df<-twListToDF(melb)
library(twitteR)
df<-twListToDF(melb)
df[1,1]
library(qdap)
x<-df[1,1]
x
polarity(x)
View(df)
x<-polarity(df$text)
gsub("[^[:alnum:]///' ]", "", df)
df2<-gsub("[^[:alnum:]///' ]", "", df)
df2<-gsub("[^[:alnum:]///' ]", "", df$text)
df2
df2[1]
x<-polarity(df2)
x
vapply
?vapply
x<-vapply(df2,polarity)
x<-lapply(df2,polarity)
head(x)
?polarity
polarity(df2,grouping.var=1:1500)
x<-polarity(df2,grouping.var=1:1500)
head(x)
x[1,1]
x[1]
df2[1:10]
hip<-df2[1:10]
hip
polarity(hip)
polarity(hip,grouping=1:10)
x<-polarity(df2,grouping=1:1500)
heaed(x)
head(X)
head(x)
hip<-df2[1:500]
x<-polarity(hip,grouping=1:500)
x
x$500
x[1,1]
x[1,2]
x[1,3]
hip<-df2[1:10]
hip
polarity(hip,grouping=1:10)
x<-polarity(hip,grouping=1:10)
dim(x)
x<-polarity(hip,grouping.var=1:10)
x
dim(x)
y<-1:10
cbind(y,hip)
hik<-cbind(y,hip)
y<-as.numeric(1:10)
hik<-cbind(y,hip)
hik[1,1]
hik[1,2]
x<-polarity(hip,grouping.var=y)
x
dim(x)
x$y
polarity(hip,grouping.var=y)
polarity(hip,grouping.var=all)
polarity(hip,all)
polarity(hip)$all
polarity(hip)$group
polarity(hip)$digits
polarity(hip)$all
df<-polarity(hip)$all
df
df$polarity
hip<-polarity(df2)$all
sum(hip$polarity>0)
sum(hip$polarity<0)
sum(hip$polarity==0)
load('perthtwit.Rdata')
pdf<-twListToDF(perth)
perth_sent<-polarity(pdf$text)$all
perth_sent<-polarity(gsub("[^[:alnum:]///' ]", "",pdf$text)$all
)
perth_sent<-polarity(gsub("[^[:alnum:]///' ]", "",pdf$text))$all
sum(perth_sent$polarity==0)
sum(perth_sent$polarity<0)
sum(perth_sent$polarity>0)
head(perth_sent)
perth_sent$neg.words
perth_text<-gsub("[^[:alnum:]///' ]", "",pdf$text)
perth_text<-gsub("-", "",pdf$text)
perth_sent<-polarity(perth_sent)$all
head(perth_sent)
perth_sent$pos.words
perth_sent$neg.words
sum(perth_sent$polarity<0)
sum(perth_sent$polarity>0)
pol<-perth_sent$polarity
head(pol)
head(pdf)
head(pdf$text)
perth_text<-pdf$text
pertht2<-gsub("[^[:alnum:]///' ]", "",perth_text)
head(pertht2)
grep(pertht2,"-")
?grep
grep("-",pertht2)
grepl("-",pertht2)
kip<-polarity(pertht2)$all
head(kip)
pos<-kip$pos.words
pos
grep("-",pos)
grepl("-",pos)
pos[grepl("-",pos)]
pos[!grepl("-",pos)]
View(hip)
View(hip)
sum(hip$polarity<0)
sum(hip$polarity>0)
sum(hip$polarity==0)
head(kip)
negwords<-kip$neg.words
negwords<-negwords[!grepl("-",negwords)]
negwords
library(wordcloud)
wordcloud(negwords)
?wordcloud
wordcloud(perth_text)
negwords
wordcorp<-Corpus(negwords)
Corpus(negwords)
?Corpus
Corpus(perth_text)
negwords<-sapply(negwords, function(x) x$getText())
negwords<-sapply(negwords, function(x) getText())
library(tm)
?getText
unlist(negwords)
Corpus(unlist(negwords))
Corpus(VectorSource(unlist(negwords)))
corp<-Corpus(VectorSource(unlist(negwords)))
wordcloud(corp)
neg
neg<-hip$polarity<0
pos<-hip$polarity>0
sum(neg)
mean(neg)
mean(pos)
dim(neg)
neg
pos<-hip[hip$polarity>0]
pos<-hip[hip$polarity>0,]
pos<-subset(hip, polarity>0)
neg<-subset(hip, polarity<0)
head(pos)
sum(pos$polarity)
sum(neg$polarity)
hip[hip$polarity<0]
hip[hip$polarity<0,]
hip$polarity[hip$polarity<0,]
hip$polarity[hip$polarity<0]
load("melbtwit.Rdata")
source('~/Documents/r_code/poly_analysis.R', echo=TRUE)
wordcloud(melb_corp)
m2<-searchTwitter('abbott', geocode='-37.807071,144.939773,50km', n=10)
load("twitter auth.Rdata")
registerTwitterOAuth(cred)
registerTwitterOAuth(twitCred)
m2<-searchTwitter('abbott', geocode='-37.807071,144.939773,50km', n=10)
m2
m2<-searchTwitter('#abbott', geocode='-37.807071,144.939773,50km', n=10)
twListToDF(m2)
m2<-searchTwitter('#Auspol', geocode='-37.807071,144.939773,50km', n=10)
twListToDF(m2)
m2<-searchTwitter('pyne', geocode='-37.807071,144.939773,50km', n=10)
twListToDF(m2)
library(ggplot2)
str(mpg)
$drv
qplot(displ,hwy,data=mpg)
qplot(displ,year,data=mpg)
qplot(model,cty,data=mpg)
qplot(displ,cty,data=mpg)
qplot(displ,cty,data=mpg, color=drv)
qplot(displ,cty,data=mpg, color=manufacturer)
qplot(displ,cty,data=mpg, color=class)
qplot(displ,cty,data=mpg, color=class, geom=c("point","smooth")
)
qplot(displ,cty,data=mpg, color=class, geom=c("point","smooth"),facets=.~class)
qplot(displ,cty,data=mpg, color=class, geom=c("point","smooth"),facets=.~drv)
qplot(displ,cty,data=mpg, geom=c("point","smooth"),facets=.~drv)
str(mpg)
qplot(displ,data=mpg)
qplot(cty,color=cyl,data=mpg)
qplot(cty,color=drv,data=mpg)
qplot(cty,fill=drv,data=mpg)
qplot(cty,fill=drv,data=mpg,geom="density")
qplot(cty,data=mpg,geom="density")
qplot(cty,data=mpg,geom="density",color=drv)
qplot(cty,data=mpg,geom="density",color=fl)
qplot(cty,data=mpg,geom="density",color=class)
library(nlme)
library(lattice)
xyplot(weight ~ Time | Diet, BodyWeight)
head(Diet)
str(Bodyweight)
str(nlme)
str(weight)
xyplot(weight ~ Time | Diet, BodyWeight)
library(datasets)
data(airquality)
qplot(Wind,Ozone, data=airquality, facets = .~factor(Month))
library(ggplor2)
library(ggplot2)
qplot(Wind,Ozone, data=airquality, facets = .~factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ factor(Month))
airquality = transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
qplot(Wind, Ozone, data = airquality)
qplot(Wind, Ozone, data = airquality, geom = "smooth")
g <- ggplot(movies, aes(votes, rating))
print(g)
qplot(votes, rating, data = movies)
qplot(votes, rating, data = movies) + geom_smooth()
qplot(votes, rating, data = movies, panel = panel.loess)
qplot(votes, rating, data = movies, smooth = "loess")
qplot(votes, rating, data = movies) + stats_smooth("loess")
g <- ggplot(movies, aes(votes, rating), data =movies)
ggplot(movies, aes(votes, rating)) + geom_point()
setwd("~/Documents/r_code/edx/unit1")
mvtWeek1 <- read.csv("~/Documents/r_code/edx/unit1/mvtWeek1.csv")
View(mvtWeek1)
str(mvtWeek1)
nrow(mvtWeek1)
max(mvtWeek1$ID)
min(mvtWeek1$Beat)
table(mvtWeek1$Arrest)
table(mvtWeek1$LocationDescription)
DateConvert = as.Date(strptime(mvtWeek1$Date,"%m/%d/%y %H:%M"))
summary(DateConvert)
mvt=mvtWeek1
mvt$Month = months(DateConvert)
mvt$Weekday = weekdays(DateConvert)
summary(mvt$Month)
View(mvt)
summary(mvt$LocationDescription)
?tapply
mvt$Date = DateConvert
mvt$Month = as.factor(mvt$Month)
summary(mvt$Month)
min(summary(mvt$Month))
mvt$Weekday = as.factor(mvt$Weekday)
min(summary(mvt$Weekday))
summary(mvt$Weekday)
h=subset(mvt,Arrest==TRUE)
summary(h$Arrest)
summary(mvt$Month)
max(summary(mvt$Month))
max(summary(h$Month))
summary(h$Month)
hist(mvt$Date, breaks=100)
?boxplot
boxplot(mvt,Date~Arrest)
boxplot(mvt,Arrest~Date)
boxplot(Date~Arrest,data=mvt)
table(mvt)
table(mvt$year)
table(mvt$Arrest)
subset(mvt,Date<2002)
subset(mvt,Year<2002)
subset(mvt,Year<2001)
subset(mvt,Year==2001)
h=subset(mvt,Year==2001)
table(h$Year)
summary(h)
table(mvt$Arrest)
table(h$Arrest)
2152/(2152+18517)
h<-table(h$Arrest)
h[1]
h[0]
h[1]
h[2]
h[2,2]
str(h)
h.[1]
h[[1]]
h[[2]]
h=subset(mvt,Year==2007)
table(h$Arrest)
1212/(1212+13068)
h=subset(mvt,Year==2012)
table(h$Arrest)
550/(550+13542)
sort(table(mvt$LocationDescription))
h=subset(mvt,LocationDescription=="STREET" | LocationDescription=="ALLEY" | LocationDescription=="GAS STATION" | LocationDescription == "DRIVEWAY - RESIDENTIAL" | LocationDescription== "PARKING LOT/GARAGE(NON.RESID.)" )
table(h$LocationDescription)
sort(table(h$LocationDescription))
h$LocationDescription = factor(h$LocationDescription)
table(h$LocationDescription)
boxplot(LocationDescription~Arrest,data=h)
str(h)
summary(h)
?table
table(h$LocationDescription,h$Arrest)
table(h$Weekday)
max(table(h$Weekday))
max(table(h$Weekday,h$LocationDescription))
table(h$Weekday,h$LocationDescription)
table(h$LocationDescription,h$Arrest)
249/2059
132/1543
439/1672
1603/13249
11595/144969
table(h$Weekday,h$LocationDescription)
BoeingStock <- read.csv("~/Documents/r_code/edx/unit1/BoeingStock.csv", stringsAsFactors=FALSE)
View(BoeingStock)
CocaColaStock <- read.csv("~/Documents/r_code/edx/unit1/CocaColaStock.csv", stringsAsFactors=FALSE)
View(CocaColaStock)
GEStock <- read.csv("~/Documents/r_code/edx/unit1/GEStock.csv", stringsAsFactors=FALSE)
View(GEStock)
ProcterGambleStock <- read.csv("~/Documents/r_code/edx/unit1/ProcterGambleStock.csv", stringsAsFactors=FALSE)
View(ProcterGambleStock)
IBM <- read.csv("~/Documents/r_code/edx/unit1/IBMStock.csv", stringsAsFactors=FALSE)
View(IBM)
Boeing = BoeingStock
CocaCola = CocaColaStock
rm(CocaColaStock)
ProctorGamble = ProcterGambleStock
rm(ProcterGambleStock)
rm(BoeingStock)
GE = GEStock
rm(GEStock)
Boeing <- read.csv("BoeingStock.csv", stringsAsFactors=FALSE)
Boeing$Date = as.Date(Boeing$Date, "%m/%d/%y")
IBM$Date = as.Date(IBM$Date, "%m/%d/%y")
GE$Date = as.Date(GE$Date, "%m/%d/%y")
CocaCola$Date = as.Date(CocaCola$Date, "%m/%d/%y")
ProcterGamble$Date = as.Date(ProcterGamble$Date, "%m/%d/%y")
ProctorGamble <- read.csv("ProctorGambleStock.csv", stringsAsFactors=FALSE)
setwd("~/Documents/r_code/edx/unit1")
ProctorGamble <- read.csv("ProctorGambleStock.csv", stringsAsFactors=FALSE)
ProcterGamble <- read.csv("ProctorGambleStock.csv", stringsAsFactors=FALSE)
ProcterGamble <- read.csv("ProcterGambleStock.csv", stringsAsFactors=FALSE)
rm(ProctorGamble)
ProcterGamble$Date = as.Date(ProcterGamble$Date, "%m/%d/%y")
summary(Date)
summary(GE$Date)
summary(CocaCola$Date)
summary(Boeing$Date)
summary(IBM$Date)
summary(ProcterGamble$Date)
View(Boeing)
mean(IBM$StockPrice)
min(GE$StockPrice)
max(CocaCola$StockPrice)
median(Boing)
summary(Boeing)
median(Boeing)
median(Boeing$StockPrice)
sd(ProcterGamble$StockPrice)
plot(CocaCola$Date,CocaCola$Stock)
plot(CocaCola$Date,CocaCola$Stock,"l")
lines(ProcterGamble$Date,ProcterGamble$StockPrice,col='blue')
abline(v=as.Date(c("2000-03-01")), lwd=2)
mean(CocaCola$StockPrice)
mean(ProcterGamble$StockPrice)
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="blue", ylim=c(0,210))
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="yellow", ylim=c(0,210))
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="black", ylim=c(0,210))
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green", ylim=c(0,210))
plot(CocaCola$Date[301:432], CocaCola$StockPrice[301:432], type="l", col="red", ylim=c(0,210))
lines(GE$Date[301:432], GE$StockPrice[301:432], type="l", col="blue", ylim=c(0,210))
lines(ProcterGamble$Date[301:432], ProcterGamble$StockPrice[301:432], type="l", col="black", ylim=c(0,210))
lines(Boeing$Date[301:432], Boeing$StockPrice[301:432], type="l", col="green", ylim=c(0,210))
lines(IBM$Date[301:432], IBM$StockPrice[301:432], type="l", col="orange", ylim=c(0,210))
View(IBM)
abline(v=as.Date(c("2000-03-01")), lwd=2)
abline(v=as.Date(c("1997-09-01")), lwd=1)
abline(v=as.Date(c("1997-11-01")), lwd=1)
abline(v=as.Date(c("2004-01-01")), lwd=1)
abline(v=as.Date(c("2006-01-01")), lwd=1)
?tapply
tapply(IBM$StockPrice,months(IBM$Date),mean)
mean(IBM$StockPrice)
tapply(IBM$StockPrice,months(IBM$Date),mean) > 144.375
tapply(GE$StockPrice,months(GE$Date),mean)
tapply(CocaCola$StockPrice,months(CocaCola$Date),mean)
max(tapply(CocaCola$StockPrice,months(CocaCola$Date),mean))
which.max(tapply(CocaCola$StockPrice,months(CocaCola$Date),mean))
which.max(tapply(GE$StockPrice,months(GE$Date),mean))
tapply(Boeing$StockPrice,months(Boeing$Date),mean)
tapply(GE$StockPrice,months(GE$Date),mean)
tapply(CocaCola$StockPrice,months(CocaCola$Date),mean)
tapply(ProcterGamble$StockPrice,months(ProcterGamble$Date),mean)
CPS <- read.csv("~/Documents/r_code/edx/unit1/CPSData.csv")
View(CPS)
summary(CPS$Industry)
sort(summary(CPS$Industry))
sort(table(CPS$Region))
sort(table(CPS$State))
table(CPS$Citizenship)
(116639+7073)/(116639+7073+7590)
(116639+7073+7590)
table(Race,Hispanic)
table(CPS$Race,CPS$Hispanic)
all(is.na(CPS))
is.na(CPS$Education)
table(CPS$Education)
summary(CPS$Education)
is.na(summary(CPS$Education))
unlist(lapply(CPS, function(x) any(is.na(x))))
table(CPS$Region, is.na(CPS$Married))
table(CPS$Sex, is.na(CPS$Married))
table(CPS$Age, is.na(CPS$Married))
View(CPS)
table(CPS$Citizenship, is.na(CPS$Married))
table(CPS$State, is.na(CPS$MetroAreaCode))
table(CPS$State, CPS$MetroAreaCode)
table(CPS$State, is.na(CPS$MetroAreaCode))
h=subset(CPS,State="Wyoming")
table(h$MetroAreaCode)
h=subset(CPS,State="New Jersey")
table(h$MetroAreaCode)
table(is.na(h$MetroAreaCode))
table(CPS$Age, is.na(CPS$Married))
table(CPS$State, is.na(CPS$MetroAreaCode))
h=subset(CPS,State="Alaska")
table(h$MetroAreaCode)
is.na(h$MetroAreaCode)
table(is.na(h$MetroAreaCode))
table(CPS$State, is.na(CPS$MetroAreaCode))
h = subset(CPS,State="Alabama")
table(is.na(h$MetroAreaCode))
h = subset(CPS,State=="Wyoming")
table(is.na(h$MetroAreaCode))
table(CPS$State, is.na(CPS$MetroAreaCode))
table(CPS$Region, is.na(CPS$MetroAreaCode))
tapply(table(CPS$Region, is.na(CPS$MetroAreaCode)),mean)
h=table(CPS$Region, is.na(CPS$MetroAreaCode))
tapply(CPS$Region,is.na(CPS$MetroAreaCode),mean)
tapply(is.na(CPS$MetroAreaCode),CPS$Region,mean)
tapply(is.na(CPS$MetroAreaCode),CPS$State,mean)
tapply(is.na(CPS$MetroAreaCode),CPS$State,mean) < 0.35
sort(tapply(is.na(CPS$MetroAreaCode),CPS$State,mean) )
MetroAreaCodes <- read.csv("~/Documents/r_code/edx/unit1/MetroAreaCodes.csv", stringsAsFactors=FALSE)
View(MetroAreaCodes)
CountryCodes <- read.csv("~/Documents/r_code/edx/unit1/CountryCodes.csv", stringsAsFactors=FALSE)
View(CountryCodes)
View(MetroAreaCodes)
CPS = merge(CPS, MetroAreaCodes, by.x="MetroAreaCode", by.y="Code", all.x=TRUE)
View(CPS)
table(CPS$MetroArea)
summary(is.na(CPS$MetroArea))
sort(summary(CPS$MetroArea))
table(CPS$MetroArea)
sort(table(CPS$MetroArea))
table(CPS$MetroArea)
kip<-table(CPS$MetroArea)
head(kip)
kip
sort(tapply(CPS$Hispanic,CPS$State,mean) )
sort(tapply(CPS$Hispanic,CPS$MetroArea,mean) )
sort(tapply(CPS$Race=="Asian",CPS$MetroArea,mean) )
sort(tapply(CPS$Education == "No high school diploma", CPS$MetroArea, mean,na.rm=TRUE))
CPS = merge(CPS, CountryCodes, by.x="CountryOfBirthCode", by.y="Code", all.x=TRUE)
View(CPS)
summary(CPS$Country)
summary(is.na(CPS$Country))
h=subset(CPS,Country!="North America")
h$Country=factor(h$COuntry)
h$Country=factor(h$Country)
table(h$Country)
sort(table(h$Country))
CPS$Country=factor(CPS$Country)
table(CPS$Country)
sort(table(CPS$Country))
h=subset(CPS,MetroArea = "New York-Northern New Jersey-Long Island, NY-NJ-PA",na.rm=TRUE)
h=subset(CPS,MetroArea == "New York-Northern New Jersey-Long Island, NY-NJ-PA",na.rm=TRUE)
table(h$Country)
sort(table(h$Country))
5409-3736
1673/5409
india = subset(CPS, Country == "India", na.rm=TRUE)
brazil = subset(CPS, Country == "Brazil", na.rm=TRUE)
somalia = subset(CPS, Country == "Somalia", na.rm=TRUE)
sort(table(india$MetroArea))
sort(table(brazil$MetroArea))
sort(table(somalia$MetroArea))
